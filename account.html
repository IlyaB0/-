<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Цветнечёк у Олечки | Мой аккаунт</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <style>
        /* Стили для страницы аккаунта */
        
        .account-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
            display: flex;
            gap: 30px;
        }
        
        /* Боковая панель меню */
        .account-sidebar {
            width: 250px;
            flex-shrink: 0;
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            height: fit-content;
            border: 1px solid var(--pale-red);
        }
        
        .user-profile {
            text-align: center;
            padding-bottom: 20px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--pale-red);
        }
        
        .user-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background-color: var(--primary-red);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-size: 2.5rem;
            margin: 0 auto 15px;
        }
        
        .user-name {
            font-size: 1.3rem;
            color: var(--dark-gray);
            margin-bottom: 5px;
        }
        
        .user-email {
            color: var(--text-gray);
            font-size: 0.9rem;
        }
        
        .account-menu {
            list-style: none;
        }
        
        .account-menu li {
            margin-bottom: 10px;
        }
        
        .account-menu a {
            color: var(--dark-gray);
            text-decoration: none;
            display: block;
            padding: 12px 15px;
            border-radius: var(--border-radius);
            transition: all 0.3s;
        }
        
        .account-menu a:hover {
            background-color: var(--pale-red);
            color: var(--primary-red);
        }
        
        .account-menu a.active {
            background-color: var(--pale-red);
            color: var(--primary-red);
            font-weight: 600;
            border-left: 3px solid var(--primary-red);
        }
        
        /* Основная часть аккаунта */
        .account-content {
            flex: 1;
        }
        
        .account-section {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
            border: 1px solid var(--pale-red);
            display: none;
        }
        
        .account-section.active {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }
        
        .section-title {
            color: var(--dark-red);
            font-size: 1.8rem;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--pale-red);
            font-family: 'Brush Script MT', cursive;
        }
        
        /* Информация о пользователе */
        .user-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .info-item {
            margin-bottom: 20px;
        }
        
        .info-label {
            color: var(--text-gray);
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .info-value {
            font-size: 1.1rem;
            color: var(--dark-gray);
            font-weight: 500;
        }
        
        /* Заказы */
        .orders-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .order-card {
            border: 1px solid var(--pale-red);
            border-radius: var(--border-radius);
            padding: 20px;
            transition: all 0.3s;
        }
        
        .order-card:hover {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--pale-red);
        }
        
        .order-id {
            font-weight: 600;
            color: var(--dark-gray);
        }
        
        .order-date {
            color: var(--text-gray);
        }
        
        .order-status {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .status-new {
            background-color: #e3f2fd;
            color: #1976d2;
        }
        
        .status-processing {
            background-color: #fff3e0;
            color: #f57c00;
        }
        
        .status-delivered {
            background-color: #e8f5e9;
            color: #388e3c;
        }
        
        .order-items {
            margin-bottom: 15px;
        }
        
        .order-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px dashed var(--pale-red);
        }
        
        .order-total {
            text-align: right;
            font-weight: 600;
            font-size: 1.2rem;
            color: var(--primary-red);
        }
        
        /* Бонусы */
        .bonus-card {
            background: linear-gradient(135deg, var(--primary-red), var(--dark-red));
            color: var(--white);
            padding: 30px;
            border-radius: var(--border-radius);
            text-align: center;
            margin-bottom: 30px;
        }
        
        .bonus-amount {
            font-size: 3.5rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .bonus-info {
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 20px;
        }
        
        .bonus-history {
            margin-top: 30px;
        }
        
        .history-item {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid var(--pale-red);
        }
        
        /* Настройки */
        .settings-form {
            max-width: 600px;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            flex: 1;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--dark-gray);
            font-weight: 500;
        }
        
        /* Избранное */
        .favorites-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
        }
        
        .favorite-card {
            background-color: var(--white);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
            position: relative;
            border: 1px solid var(--pale-red);
        }
        
        .favorite-card:hover {
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        .remove-favorite {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: var(--white);
            border: none;
            color: var(--primary-red);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 1;
        }
        
        .favorite-image {
            height: 180px;
            overflow: hidden;
        }
        
        .favorite-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s;
        }
        
        .favorite-card:hover .favorite-image img {
            transform: scale(1.05);
        }
        
        .favorite-content {
            padding: 20px;
        }
        
        .favorite-title {
            font-size: 1.2rem;
            color: var(--dark-gray);
            margin-bottom: 10px;
        }
        
        .favorite-price {
            color: var(--primary-red);
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .no-data {
            text-align: center;
            padding: 50px 20px;
            color: var(--text-gray);
        }
        
        .no-data i {
            font-size: 3rem;
            color: var(--pale-red);
            margin-bottom: 20px;
        }
        
        /* Адаптивность */
        @media (max-width: 992px) {
            .account-container {
                flex-direction: column;
            }
            
            .account-sidebar {
                width: 100%;
            }
            
            .user-info-grid {
                grid-template-columns: 1fr;
            }
            
            .favorites-grid {
                grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            }
        }
        
        @media (max-width: 768px) {
            .account-section {
                padding: 20px;
            }
            
            .order-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <!-- Проверка авторизации -->
    <script>
        if (!localStorage.getItem('currentUser')) {
            window.location.href = 'index.html';
        }
    </script>
    
    <!-- Шапка сайта -->
<header class="header">
    <div class="header-container">
        <div class="header-main">
            <div class="logo-section">
                <div class="logo-icon-wrapper">
                    <i class="fas fa-spa"></i>
                </div>
                <div class="logo-text">
                    <h1 class="logo-title">Цветничок у Оли</h1>
                    <p class="logo-subtitle">Красивые цветы для вашего настроения</p>
                </div>
            </div>
            
            <div class="header-contacts">
                <div class="contact-item">
                    <i class="fas fa-phone"></i>
                    <div class="contact-info">
                        <span class="contact-number">+375 25 530-99-49</span>
                        <span class="contact-number">+375 33 623-94-33</span>
                    </div>
                </div>
                <div class="contact-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <span class="contact-address">г.п. Вороново, ул. Аэродромная, д. 25</span>
                </div>
            </div>
            
            <div class="header-actions">
                <div class="user-section">
                    <span id="user-greeting"></span>
                    <a href="#" id="logout" class="logout-btn">Выйти</a>
                </div>
                <a href="cart.html" class="cart-button" id="open-cart">
                    <i class="fas fa-shopping-basket"></i>
                    <span class="cart-badge" id="cart-count">0</span>
                </a>
            </div>
        </div>
        
        <nav class="main-nav">
            <a href="home.html" class="nav-link">
                <i class="fas fa-home"></i>
                <span>Главная</span>
            </a>
            <a href="catalog.html" class="nav-link">
                <i class="fas fa-th-large"></i>
                <span>Каталог</span>
            </a>
            <a href="contacts.html" class="nav-link">
                <i class="fas fa-address-book"></i>
                <span>Контакты</span>
            </a>
            <a href="account.html" class="nav-link active">
                <i class="fas fa-user"></i>
                <span>Мой аккаунт</span>
            </a>
                  </a>
  <a href="news.html" class="nav-link">
                <i class="fas fa-newspaper"></i>
                <span>Новости</span>
            </a>
        </nav>
    </div>
</header>
    <!-- Основной контент аккаунта -->
    <div class="account-container">
        <!-- Боковая панель -->
        <aside class="account-sidebar">
            <div class="user-profile">
                <div class="user-avatar" id="user-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <h3 class="user-name" id="user-name">Пользователь</h3>
                <p class="user-email" id="user-email">email@example.com</p>
            </div>
            
            <ul class="account-menu">
                <li><a href="#" class="active" data-section="profile">Мой профиль</a></li>
                <li><a href="#" data-section="orders">Мои заказы</a></li>
                <li><a href="#" data-section="bonuses">Бонусы</a></li>
                <li><a href="#" data-section="favorites">Избранное</a></li>
                <li><a href="#" data-section="settings">Настройки</a></li>
            </ul>
        </aside>
        
        <!-- Основной контент -->
        <main class="account-content">
            <!-- Профиль -->
            <section id="profile-section" class="account-section active">
                <h2 class="section-title">Мой профиль</h2>
                
                <div class="user-info-grid">
                    <div class="info-item">
                        <div class="info-label">Имя</div>
                        <div class="info-value" id="profile-name">Загрузка...</div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-label">Email</div>
                        <div class="info-value" id="profile-email">Загрузка...</div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-label">Телефон</div>
                        <div class="info-value" id="profile-phone">Загрузка...</div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-label">Дата регистрации</div>
                        <div class="info-value" id="profile-registration">Загрузка...</div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-label">Статус</div>
                        <div class="info-value">
                            <span style="color: var(--primary-red); font-weight: 600;">Постоянный клиент</span>
                        </div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-label">Скидка</div>
                        <div class="info-value" id="profile-discount">Загрузка...</div>
                    </div>
                </div>
                
                <div style="margin-top: 40px; padding-top: 20px; border-top: 2px solid var(--pale-red);">
                    <h3 style="color: var(--dark-red); margin-bottom: 20px;">Статистика покупок</h3>
                    
                    <div style="display: flex; gap: 30px; flex-wrap: wrap;">
                        <div style="text-align: center;">
                            <div style="font-size: 2.5rem; color: var(--primary-red); font-weight: bold;" id="stats-orders">0</div>
                            <div style="color: var(--text-gray);">Всего заказов</div>
                        </div>
                        
                        <div style="text-align: center;">
                            <div style="font-size: 2.5rem; color: var(--primary-red); font-weight: bold;" id="stats-total">0</div>
                            <div style="color: var(--text-gray);">Общая сумма</div>
                        </div>
                        
                        <div style="text-align: center;">
                            <div style="font-size: 2.5rem; color: var(--primary-red); font-weight: bold;" id="stats-avg">0</div>
                            <div style="color: var(--text-gray);">Средний чек</div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Заказы -->
            <section id="orders-section" class="account-section">
                <h2 class="section-title">Мои заказы</h2>
                
                <div class="orders-list" id="orders-list">
                    <!-- Заказы будут загружены через JavaScript -->
                </div>
                
                <div class="no-data" id="no-orders" style="display: none;">
                    <i class="fas fa-box-open"></i>
                    <h3>У вас еще нет заказов</h3>
                    <p>Совершите свою первую покупку в нашем магазине!</p>
                    <a href="catalog.html" class="btn btn-primary" style="margin-top: 20px;">Перейти в каталог</a>
                </div>
            </section>
            
            <!-- Бонусы -->
            <section id="bonuses-section" class="account-section">
                <h2 class="section-title">Мои бонусы</h2>
                
                <div class="bonus-card">
                    <div class="bonus-amount" id="bonus-amount">0</div>
                    <div class="bonus-info">бонусных баллов доступно</div>
                    <p>1 бонус = 10 копеек. Максимум 3000 бонусов. Начисление: 1 бонус за каждые 2 рубля покупки.</p>
                </div>
                
                <div class="bonus-history">
                    <h3 style="color: var(--dark-red); margin-bottom: 20px;">История начисления бонусов</h3>
                    
                    <div id="bonus-history">
                        <!-- История бонусов будет загружена через JavaScript -->
                    </div>
                    
                    <div class="no-data" id="no-bonus-history" style="display: none;">
                        <i class="fas fa-gift"></i>
                        <p>У вас еще нет истории начисления бонусов</p>
                    </div>
                </div>
            </section>
            
            <!-- Избранное -->
            <section id="favorites-section" class="account-section">
                <h2 class="section-title">Избранное</h2>
                
                <div class="favorites-grid" id="favorites-grid">
                    <!-- Избранные товары будут загружены через JavaScript -->
                </div>
                
                <div class="no-data" id="no-favorites" style="display: none;">
                    <i class="fas fa-heart"></i>
                    <h3>У вас пока нет избранных товаров</h3>
                    <p>Добавляйте товары в избранное, чтобы не потерять их!</p>
                    <a href="catalog.html" class="btn btn-primary" style="margin-top: 20px;">Перейти в каталог</a>
                </div>
            </section>
            
            <!-- Настройки -->
            <section id="settings-section" class="account-section">
                <h2 class="section-title">Настройки аккаунта</h2>
                
                <form class="settings-form" id="settings-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="settings-name">Имя</label>
                            <input type="text" id="settings-name" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="settings-phone">Телефон</label>
                            <input type="tel" id="settings-phone">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="settings-email">Email</label>
                            <input type="email" id="settings-email" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="settings-birthday">Дата рождения</label>
                            <input type="date" id="settings-birthday">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="settings-address">Адрес доставки</label>
                        <textarea id="settings-address" rows="3"></textarea>
                    </div>
                    
                    <h3 style="color: var(--dark-red); margin: 30px 0 20px;">Смена пароля</h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="current-password">Текущий пароль</label>
                            <input type="password" id="current-password">
                        </div>
                        
                        <div class="form-group">
                            <label for="new-password">Новый пароль</label>
                            <input type="password" id="new-password">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="confirm-password">Подтвердите новый пароль</label>
                        <input type="password" id="confirm-password">
                    </div>
                    
                    <div style="margin-top: 30px;">
                        <button type="submit" class="btn btn-primary">Сохранить изменения</button>
                    </div>
                </form>
            </section>
        </main>
    </div>
    
    <!-- Футер -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-column">
                <h3>Цветнечёк у Олечки</h3>
                <p>Магазин цветов с душой. Мы создаем красивые букеты, которые дарят радость и выражают ваши чувства.</p>
                <div class="social-icons">
                    <a href="#"><i class="fab fa-vk"></i></a>
                    <a href="#"><i class="fab fa-telegram"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-whatsapp"></i></a>
                </div>
            </div>
            
            <div class="footer-column">
                <h3>Магазин</h3>
                <ul class="footer-links">
                    <li><a href="catalog.html">Каталог букетов</a></li>
                    <li><a href="home.html">Акции и скидки</a></li>
                </ul>
            </div>
            
            <div class="footer-column">
                <h3>Помощь</h3>
                <ul class="footer-links">
                    <li><a href="#">Доставка и оплата</a></li>
                    <li><a href="#">Уход за цветами</a></li>
                    <li><a href="#">Частые вопросы</a></li>
                    <li><a href="contacts.html">Контакты</a></li>
                </ul>
            </div>
            
            <div class="footer-column">
                <h3>Контакты</h3>
                <p><i class="fas fa-map-marker-alt"></i> г.п. Вороново, ул. Аэродромная, д. 25</p>
                <p><i class="fas fa-phone"></i> +375 25 530-99-49 / +375 (33) 623-94-33</p>
                <p><i class="fas fa-envelope"></i> ilyabalt345ilya1@gmail.com / olgabalts@gmail.com</p>
                <p><i class="fas fa-clock"></i> Ежедневно с 10:00 до 20:00</p>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2026 Магазин цветов "Цветнечёк у Олечки". Все права защищены.</p>
        </div>
    </footer>

    <script>
        // Данные пользователя
        const currentUser = JSON.parse(localStorage.getItem('currentUser'));
        
        // База товаров для избранного - ОБЯЗАТЕЛЬНО СКОПИРУЙТЕ ВЕСЬ МАССИВ СЮДА!
        // Скопируйте весь массив allFlowers из catalog.html
        const allFlowers = [
            // ТОВАР 1
            {
                id: 1,
                name: "Георгины вегетативные низкорослые",
                category: "roses",
                price: 8,
                oldPrice: 12,
                description: "",
                image: "https://i.okcdn.ru/i?r=CFRAm_VFBkioSGBqh1KLntt06MFo4g5uSnK0cvpuqrPJ995xVi3fxSXrV17J_etk9d0segI-1U3enf481quDrAG8n2RMBiefhyQv195j0SSEkZlA_QAAACk",
                additionalImages: [
                    "https://i.okcdn.ru/i?r=CFRAm_VFBkioSGBqh1L-Q6HqbHCWrB7TMQfD4uHb1U9QlM6-gu90yAdFwhFR_Ss2AZr4dlandPb91NdTV7XEdUGwflfxgfq799peuRD-t18gzqvtewAAACkhttps://i.okcdn.ru/i?r=CFRAm_VFBkioSGBqh1L-Q6HqbHCWrB7TMQfD4uHb1U9QlM6-gu90yAdFwhFR_Ss2AZr4dlandPb91NdTV7XEdUGwflfxgfq799peuRD-t18gzqvtewAAACk",
                    "https://i.okcdn.ru/i?r=CFRAm_VFBkioSGBqh1IdniE7GUPPC8HhwHLqxIWeU0FuPGfPZWTZRZ0yxeWE9Y4QyJyIEdLAvDsmmrAjB01wCDVPmzDgxNsQ9OwGoqm2h0LAnWfjdAAAACk",
                    "https://i.okcdn.ru/i?r=CFRAm_VFBkioSGBqh1JNLF-knqUNnWO9cbgYg-MTmloc-tohvgpq_tJQ2LWsHH-CmIR9bn8xQlyUcq7_lh8OvL8AjZhdPiExyXiIeQIsWFNakjm8igAAACk"
                ],
                specifications: {
                    "Тип": "Розы",
                    "Количество в букете": "25 шт",
                    "Длина стебля": "50-60 см",
                    "Цвет": "Красный",
                    "Страна происхождения": "Эквадор",
                    "Срок доставки": "1-2 дня",
                    "Упаковка": "Пленка и лента",
                    "Срок стояния": "7-10 дней"
                },
                badge: "ХИТ",
                popular: true
            },
            // ТОВАР 2
            {
                id: 2, 
                name: "Бальзамин новогвинейский", 
                category: "roses", 
                price: 9, 
                oldPrice: 15, 
                description: "Декоративный бальзамин с яркими цветами",
                image: "https://i.okcdn.ru/i?r=CFRAm_VFBkioSGBqh1IKUtFwKHEdY8wagSMfym_uNdySumU0muPNNzMA_YkvAJr0qZWh0LUrQHkkrKLFoR_NKBNgH88vL7jCk33EPsT0KoYMXUWEAgAAACk",
                additionalImages: [
                    "https://i.okcdn.ru/i?r=CFRAm_VFBkioSGBqh1JR8mnSjEMpnXylkk4uJj1sN_jEGADWqd1Jl2-M3TtHHQ3EYsVNLHp4wMgFpHdCSw_g_O4UshglpBoFAp2-QQQyGX90OfsnLwAAACk",
                    "https://i.okcdn.ru/i?r=CFRAm_VFBkioSGBqh1JFW310ObGGf8gyBPGQ_U3ISh1IU7evfYRZEWSD2V0UII4lVgj0Utmo1NvY8WAfYlmtr4nRmZCAtcA8jkpRnwvnJAbVYtunIgAAACk",
                    "https://i.okcdn.ru/i?r=CFRAm_VFBkioSGBqh1Ld2F_13Pu-czK4jYqGZ10_jor_I1LBiv8nrltmLded4rXREZSWCzcyBu3PCZXxMP8PUbxFHyMU-bbSGAWVUT9rHQFXKmBZUQAAACk"
                ],
                badge: "ХИТ", 
                popular: true,
                specifications: {
                    "Тип": "Бальзамин",
                    "Длина стебля": "5-6 см",
                    "Цвет": "Разный",
                    "Страна происхождения": "Эквадор",
                    "Срок доставки": "1-2 дня",
                    "Срок стояния": "7-10 дней"
                }
            },
            // ТОВАР 3
            {
                id: 3, 
                name: "Бегонии", 
                category: "roses", 
                price: 6, 
                oldPrice: 10, 
                description: "",
                image: "https://i.okcdn.ru/i?r=CFxAm_VFBkioSGBqh1LamAAOc8pbUTclt-RyglJI6NK9iz8eUjTKfFt-d3OFUsyZsqltUpmMLTCX19JX_Uh8fEGjMNCf3zMd-p_D-QeyziEhVmlGoAgunXwsIg68AAAAKQ",
                additionalImages: [
                    "",
                    "",
                    ""
                ],
                badge: "", 
                popular: true,
                specifications: {
                    "Тип": "Бегония",
                    "Длина стебля": "1-7 см",
                    "Цвет": "Разный",
                    "Страна происхождения": "Эквадор",
                    "Срок доставки": "1-2 дня",
                    "Срок стояния": "7-10 дней"
                }
            },
            // ДОБАВЬТЕ ВСЕ ОСТАЛЬНЫЕ ТОВАРЫ ЗДЕСЬ
        ];
        
        // Инициализация
        document.addEventListener('DOMContentLoaded', function() {
            // Загружаем данные пользователя
            loadUserData();
            
            // Переключение между разделами
            document.querySelectorAll('.account-menu a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Убираем активный класс у всех ссылок
                    document.querySelectorAll('.account-menu a').forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    // Добавляем активный класс текущей ссылке
                    this.classList.add('active');
                    
                    // Скрываем все разделы
                    document.querySelectorAll('.account-section').forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    // Показываем выбранный раздел
                    const sectionId = this.getAttribute('data-section') + '-section';
                    document.getElementById(sectionId).classList.add('active');
                });
            });
            
            // Выход из аккаунта
            document.getElementById('logout').addEventListener('click', function(e) {
                e.preventDefault();
                localStorage.removeItem('currentUser');
                window.location.href = 'index.html';
            });
            
            // Обновление данных профиля
            document.getElementById('settings-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const name = document.getElementById('settings-name').value;
                const email = document.getElementById('settings-email').value;
                const phone = document.getElementById('settings-phone').value;
                const address = document.getElementById('settings-address').value;
                const currentPassword = document.getElementById('current-password').value;
                const newPassword = document.getElementById('new-password').value;
                const confirmPassword = document.getElementById('confirm-password').value;
                
                // Обновляем данные пользователя в localStorage
                const users = JSON.parse(localStorage.getItem('flowerShopUsers')) || [];
                const userIndex = users.findIndex(u => u.email === currentUser.email);
                
                if (userIndex !== -1) {
                    // Обновляем основные данные
                    users[userIndex].name = name;
                    users[userIndex].email = email;
                    users[userIndex].phone = phone;
                    users[userIndex].address = address;
                    
                    // Если меняем пароль
                    if (currentPassword && newPassword && confirmPassword) {
                        if (users[userIndex].password === currentPassword) {
                            if (newPassword === confirmPassword) {
                                users[userIndex].password = newPassword;
                                alert('Пароль успешно изменен!');
                            } else {
                                alert('Новый пароль и подтверждение не совпадают');
                                return;
                            }
                        } else {
                            alert('Текущий пароль неверен');
                            return;
                        }
                    }
                    
                    localStorage.setItem('flowerShopUsers', JSON.stringify(users));
                    
                    // Обновляем текущего пользователя
                    const updatedUser = {
                        ...currentUser,
                        name,
                        email,
                        phone,
                        address
                    };
                    localStorage.setItem('currentUser', JSON.stringify(updatedUser));
                    
                    // Обновляем отображение
                    loadUserData();
                    
                    alert('Данные успешно сохранены!');
                }
            });
        });
        
        // Загрузка данных пользователя
        function loadUserData() {
            if (!currentUser) return;
            
            // Загружаем полные данные пользователя
            const users = JSON.parse(localStorage.getItem('flowerShopUsers')) || [];
            const userData = users.find(u => u.email === currentUser.email);
            
            if (userData) {
                // Профиль
                document.getElementById('user-name').textContent = userData.name;
                document.getElementById('user-email').textContent = userData.email;
                document.getElementById('user-greeting').textContent = `Привет, ${userData.name}!`;
                
                // Инициалы для аватара
                const initials = userData.name.split(' ').map(n => n[0]).join('').toUpperCase();
                document.getElementById('user-avatar').innerHTML = initials || '<i class="fas fa-user"></i>';
                
                // Информация в профиле
                document.getElementById('profile-name').textContent = userData.name;
                document.getElementById('profile-email').textContent = userData.email;
                document.getElementById('profile-phone').textContent = userData.phone || 'Не указан';
                document.getElementById('profile-registration').textContent = userData.registrationDate ? new Date(userData.registrationDate).toLocaleDateString('ru-RU') : 'Неизвестно';
                
                // Статистика
                const orders = userData.orders || [];
                const totalOrders = orders.length;
                const totalAmount = orders.reduce((sum, order) => sum + order.total, 0);
                const avgOrder = totalOrders > 0 ? Math.round(totalAmount / totalOrders) : 0;
                
                document.getElementById('stats-orders').textContent = totalOrders;
                document.getElementById('stats-total').textContent = `${totalAmount} руб.`;
                document.getElementById('stats-avg').textContent = `${avgOrder} руб.`;
                document.getElementById('profile-discount').textContent = totalOrders >= 5 ? '10%' : '5%';
                
                // Заказы
                loadOrders(orders);
                
                // Бонусы
                loadBonuses(userData);
                
                // Избранное
                const favorites = userData.favorites || [];
                loadFavorites(favorites);
                
                // Настройки
                document.getElementById('settings-name').value = userData.name;
                document.getElementById('settings-email').value = userData.email;
                document.getElementById('settings-phone').value = userData.phone || '';
                document.getElementById('settings-address').value = userData.address || '';
            }
        }
        
        // Загрузка заказов
        function loadOrders(orders) {
            const ordersList = document.getElementById('orders-list');
            const noOrders = document.getElementById('no-orders');
            
            if (orders.length === 0) {
                ordersList.style.display = 'none';
                noOrders.style.display = 'block';
                return;
            }
            
            ordersList.style.display = 'flex';
            noOrders.style.display = 'none';
            ordersList.innerHTML = '';
            
            // Сортируем заказы по дате (новые сначала)
            orders.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            orders.forEach(order => {
                const orderCard = document.createElement('div');
                orderCard.className = 'order-card';
                
                // Определяем статус
                let statusClass = 'status-new';
                let statusText = 'новый';
                
                if (order.status === 'processing') {
                    statusClass = 'status-processing';
                    statusText = 'в обработке';
                } else if (order.status === 'delivered') {
                    statusClass = 'status-delivered';
                    statusText = 'доставлен';
                }
                
                // Форматируем дату
                const orderDate = new Date(order.date);
                const formattedDate = orderDate.toLocaleDateString('ru-RU', {
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric'
                });
                
                orderCard.innerHTML = `
                    <div class="order-header">
                        <div>
                            <div class="order-id">Заказ #${order.id.toString().slice(-6)}</div>
                            <div class="order-date">${formattedDate}</div>
                        </div>
                        <div class="order-status ${statusClass}">${statusText}</div>
                    </div>
                    
                    <div class="order-items">
                        ${order.items ? order.items.map(item => `
                            <div class="order-item">
                                <span>${item.name} × ${item.quantity}</span>
                                <span>${item.price * item.quantity} руб.</span>
                            </div>
                        `).join('') : ''}
                    </div>
                    
                    <div class="order-total">
                        Итого: ${order.total} руб.
                    </div>
                `;
                
                ordersList.appendChild(orderCard);
            });
        }
        
        // Система бонусов: 1 бонус за каждые 2 рубля, максимум 3000 бонусов
        function calculateBonuses(totalAmount) {
            // 1 бонус = 2 рубля, округляем вниз
            let bonuses = Math.floor(totalAmount / 2);
            
            // Максимум 3000 бонусов
            bonuses = Math.min(bonuses, 3000);
            
            return bonuses;
        }
        
        // Загрузка бонусов
        function loadBonuses(userData) {
            const orders = userData.orders || [];
            const totalAmount = orders.reduce((sum, order) => sum + order.total, 0);
            
            // Рассчитываем бонусы
            const earnedBonuses = calculateBonuses(totalAmount);
            const usedBonuses = userData.usedBonuses || 0;
            const currentBonuses = Math.max(0, earnedBonuses - usedBonuses);
            
            // Отображаем бонусы
            document.getElementById('bonus-amount').textContent = currentBonuses;
            
            // Загружаем историю бонусов
            loadBonusHistory(orders, userData);
        }
        
        // Загрузка истории бонусов
        function loadBonusHistory(orders, userData) {
            const bonusHistory = document.getElementById('bonus-history');
            const noBonusHistory = document.getElementById('no-bonus-history');
            
            if (orders.length === 0 && (!userData.bonusHistory || userData.bonusHistory.length === 0)) {
                bonusHistory.style.display = 'none';
                noBonusHistory.style.display = 'block';
                return;
            }
            
            bonusHistory.style.display = 'block';
            noBonusHistory.style.display = 'none';
            bonusHistory.innerHTML = '';
            
            // Показываем историю из заказов
            orders.forEach(order => {
                const orderBonuses = calculateBonuses(order.total);
                
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                
                // Форматируем дату
                const orderDate = new Date(order.date);
                const formattedDate = orderDate.toLocaleDateString('ru-RU');
                
                historyItem.innerHTML = `
                    <div>
                        <div style="font-weight: 500;">Заказ #${order.id.toString().slice(-6)}</div>
                        <div style="color: var(--text-gray); font-size: 0.9rem;">${formattedDate}</div>
                    </div>
                    <div style="color: #4CAF50; font-weight: 600;">+${orderBonuses} бонусов</div>
                `;
                
                bonusHistory.appendChild(historyItem);
            });
            
            // Показываем историю списания бонусов
            if (userData.bonusHistory) {
                userData.bonusHistory.forEach(history => {
                    if (history.type === 'spent') {
                        const historyItem = document.createElement('div');
                        historyItem.className = 'history-item';
                        
                        historyItem.innerHTML = `
                            <div>
                                <div style="font-weight: 500;">${history.description}</div>
                                <div style="color: var(--text-gray); font-size: 0.9rem;">${history.date}</div>
                            </div>
                            <div style="color: #f44336; font-weight: 600;">-${history.amount} бонусов</div>
                        `;
                        
                        bonusHistory.appendChild(historyItem);
                    }
                });
            }
        }
        
        // ЗАГРУЗКА ИЗБРАННОГО - ОСНОВНАЯ ФУНКЦИЯ
        function loadFavorites(favoriteIds) {
            const favoritesGrid = document.getElementById('favorites-grid');
            const noFavorites = document.getElementById('no-favorites');
            
            if (!favoriteIds || favoriteIds.length === 0) {
                favoritesGrid.style.display = 'none';
                noFavorites.style.display = 'block';
                return;
            }
            
            favoritesGrid.style.display = 'grid';
            noFavorites.style.display = 'none';
            favoritesGrid.innerHTML = '';
            
            // Фильтруем товары по ID из избранного
            const favoriteProducts = allFlowers.filter(product => 
                favoriteIds.includes(product.id)
            );
            
            if (favoriteProducts.length === 0) {
                favoritesGrid.style.display = 'none';
                noFavorites.style.display = 'block';
                return;
            }
            
            favoriteProducts.forEach(product => {
                const favoriteCard = document.createElement('div');
                favoriteCard.className = 'favorite-card';
                
                favoriteCard.innerHTML = `
                    <button class="remove-favorite" onclick="removeFromFavorites(${product.id})">
                        <i class="fas fa-times"></i>
                    </button>
                    <div class="favorite-image">
                        <img src="${product.image}" alt="${product.name}">
                    </div>
                    <div class="favorite-content">
                        <h3 class="favorite-title">${product.name}</h3>
                        <div class="favorite-price">${product.price} руб.</div>
                        <div class="product-actions" style="display: flex; gap: 10px;">
                            <button class="btn btn-primary btn-small" onclick="addToCartFromFavorites(${product.id})">В корзину</button>
                            <button class="btn-outline" onclick="viewProduct(${product.id})">Подробнее</button>
                        </div>
                    </div>
                `;
                
                favoritesGrid.appendChild(favoriteCard);
            });
        }
        
        // Функция для просмотра товара из избранного
        window.viewProduct = function(productId) {
            window.location.href = `product-details.html?id=${productId}`;
        };
        
        // Функция для добавления в корзину из избранного
        window.addToCartFromFavorites = function(productId) {
            addToCart(productId);
            
            // Показываем уведомление
            const product = allFlowers.find(p => p.id === productId);
            if (product) {
                showNotification(`"${product.name}" добавлен в корзину!`);
            }
        };
        
        // Удаление из избранного
        window.removeFromFavorites = function(productId) {
            if (confirm('Удалить товар из избранного?')) {
                const currentUser = JSON.parse(localStorage.getItem('currentUser'));
                const users = JSON.parse(localStorage.getItem('flowerShopUsers')) || [];
                const userIndex = users.findIndex(u => u.email === currentUser.email);
                
                if (userIndex !== -1) {
                    if (!users[userIndex].favorites) {
                        users[userIndex].favorites = [];
                    }
                    
                    users[userIndex].favorites = users[userIndex].favorites.filter(id => id !== productId);
                    localStorage.setItem('flowerShopUsers', JSON.stringify(users));
                    
                    // Обновляем отображение
                    const updatedFavorites = users[userIndex].favorites;
                    loadFavorites(updatedFavorites);
                    
                    // Показываем уведомление
                    showNotification('Товар удален из избранного');
                }
            }
        };
        
        // Функция добавления в корзину
        function addToCart(productId) {
            const product = allFlowers.find(p => p.id === productId);
            
            if (!product) return;
            
            let cart = JSON.parse(localStorage.getItem('flowerCart')) || [];
            
            // Проверяем, есть ли товар уже в корзине
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    image: product.image,
                    quantity: 1
                });
            }
            
            // Сохраняем в localStorage
            localStorage.setItem('flowerCart', JSON.stringify(cart));
            
            // Обновляем счетчик корзины
            updateCartCount();
        }
        
        // Функция для отображения уведомлений
        function showNotification(message) {
            // Создаем элемент уведомления
            let notification = document.getElementById('notification');
            if (!notification) {
                notification = document.createElement('div');
                notification.id = 'notification';
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background-color: var(--primary-red);
                    color: white;
                    padding: 15px 25px;
                    border-radius: var(--border-radius);
                    z-index: 10000;
                    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                    display: none;
                    transition: all 0.3s;
                `;
                document.body.appendChild(notification);
            }
            
            notification.textContent = message;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }
        
        // Обновление счетчика корзины
        function updateCartCount() {
            const cart = JSON.parse(localStorage.getItem('flowerCart')) || [];
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cart-count').textContent = totalItems;
        }
        
        // Инициализация счетчика корзины
        updateCartCount();
    </script>
</body>
</html>